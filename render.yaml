services:
  # Single web service that exposes health endpoints and runs the sync loop
  - type: web
    name: notion-sync-service
    env: node
    plan: free
    buildCommand: npm install && npm run build
    startCommand: npm run start
    envVars:
      - key: NOTION_TOKEN
        sync: false  # Set this in Render dashboard
      - key: NOTION_DATABASE_ID
        sync: false  # Optional single database
      - key: NOTION_DATABASE_MAPPING
        sync: false  # Optional JSON mapping for multiple banks
      - key: DATA_SOURCE
        value: sftp  # Options: sftp | mock-http
      - key: SFTP_HOST
        value: localhost  # Update with real SFTP host when available
      - key: SFTP_PORT
        value: 2222  # Update with real SFTP port when available
      - key: SFTP_USERNAME
        value: andbank  # Update with real SFTP username when available
      - key: SFTP_PASSWORD
        value: sftp-test  # Update with real SFTP password when available
      - key: SFTP_REMOTE_PATH
        value: /loans.csv  # Update with real CSV path when available
      - key: AUTO_START_MOCK_SFTP
        value: "true"  # Set to false when using real SFTP
      - key: SYNC_INTERVAL_MINUTES
        value: 15

